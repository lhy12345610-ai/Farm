<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ìš°ë¦¬ ë†ì¥ í†µí•© ê´€ë¦¬</title>
    <style>
        :root { --main-pink: #ffafbd; --bg: #f8f9fa; --building-bg: #ffffff; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding: 15px; }
        h1 { font-size: 1.2rem; text-align: center; color: #333; margin-bottom: 20px; }

        /* ì¡°ê°ë„ ë ˆì´ì•„ì›ƒ */
        .farm-map { display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; margin-bottom: 20px; }
        .map-building { 
            background: var(--building-bg); border: 2px solid #ddd; border-radius: 10px; padding: 10px;
            text-align: center; cursor: pointer; min-height: 80px; display: flex; flex-direction: column;
            justify-content: center; align-items: center; box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        .map-building:active { background: var(--main-pink); color: white; }
        .map-building b { font-size: 0.85rem; display: block; }
        .map-building span { font-size: 0.7rem; color: #666; margin-top: 5px; }

        /* ìƒì„¸ í™”ë©´ (ëª¨ë‹¬ ë°©ì‹) */
        #detail-view { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: white; z-index: 100; overflow-y: auto; padding: 20px 10px; box-sizing: border-box;
        }
        .close-btn { 
            display: block; width: 100%; padding: 15px; background: #333; color: white; 
            border: none; border-radius: 8px; margin-bottom: 20px; font-size: 1rem;
        }

        /* ëˆë°© ê·¸ë¦¬ë“œ ì„¤ì • */
        .grid-container { display: grid; gap: 8px; }
        .room-title { background: #eee; padding: 5px; font-size: 0.8rem; font-weight: bold; margin-top: 10px; grid-column: 1 / -1; }
        .cell { 
            aspect-ratio: 1/1; border: 1.5px solid #eee; border-radius: 8px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; background: #fff;
        }
        .cell span { font-size: 0.6rem; color: #999; }
        .cell b { font-size: 1.1rem; }
        
        /* ìƒíƒœ ìƒ‰ìƒ */
        .active { background: #e8f5e9; border-color: #a5d6a7; color: #2e7d32; }
        .full { background: #ffebee; border-color: #ef9a9a; color: #c62828; }
    </style>
</head>
<body>

<h1>ğŸ· ë†ì¥ ì „ì²´ ì¡°ê°ë„</h1>

<div class="farm-map">
    <div class="map-building" onclick="openBuilding('farrow1')"><b>ë¶„ë§Œ 1</b><span>8ì¹¸</span></div>
    <div class="map-building" onclick="openBuilding('farrow2')"><b>ë¶„ë§Œ 2,3</b><span>12ì¹¸</span></div>
    <div class="map-building" onclick="openBuilding('nursery')"><b>ìëˆì‚¬</b><span>5ë°©/20ì¹¸</span></div>
    <div class="map-building" onclick="openBuilding('grower')"><b>ìœ¡ì„±ì‚¬</b><span>6ë°©/36ì¹¸</span></div>
    <div class="map-building" onclick="openBuilding('gilt')"><b>í›„ë³´ì‚¬</b><span>ê´€ë¦¬</span></div>
    <div class="map-building" onclick="openBuilding('mating')"><b>ì¢…ë¶€ì‚¬</b><span>ê´€ë¦¬</span></div>
</div>

<div class="farm-map" style="grid-template-columns: repeat(5, 1fr);">
    <div class="map-building" onclick="openBuilding('finisher1')"><b>ë¹„ìœ¡ 1</b><span>12ì¹¸</span></div>
    <div class="map-building" onclick="openBuilding('finisher2')"><b>ë¹„ìœ¡ 2</b><span>22ì¹¸</span></div>
    <div class="map-building" onclick="openBuilding('finisher3')"><b>ë¹„ìœ¡ 3</b><span>21ì¹¸</span></div>
    <div class="map-building" onclick="openBuilding('gestation4')"><b>ì„ì‹  4</b><span>ê´€ë¦¬</span></div>
    <div class="map-building" onclick="openBuilding('gestation5')) "><b>ì„ì‹  5</b><span>ê´€ë¦¬</span></div>
</div>

<div id="detail-view">
    <button class="close-btn" onclick="closeBuilding()">â† ì „ì²´ ì§€ë„ë¡œ ëŒì•„ê°€ê¸°</button>
    <h2 id="detail-title" style="text-align:center;"></h2>
    <div id="detail-grid" class="grid-container"></div>
</div>

<script>
    const buildings = {
        'farrow1': { title: 'ë¶„ë§Œì‚¬ 1ë™', layout: 'single', count: 8 },
        'farrow2': { title: 'ë¶„ë§Œì‚¬ 2,3ë™', layout: 'single', count: 12 },
        'nursery': { title: 'ìëˆì‚¬', layout: 'room', rooms: 5, perRoom: 4 },
        'grower': { title: 'ìœ¡ì„±ì‚¬', layout: 'room', rooms: 6, perRoom: 6 },
        'finisher1': { title: 'ë¹„ìœ¡ì‚¬ 1ë™', layout: 'lr', count: 12 },
        'finisher2': { title: 'ë¹„ìœ¡ì‚¬ 2ë™', layout: 'lr', count: 22 },
        'finisher3': { title: 'ë¹„ìœ¡ì‚¬ 3ë™', layout: 'single', count: 21 },
        'gilt': { title: 'í›„ë³´ì‚¬', layout: 'single', count: 10 },
        'mating': { title: 'ì¢…ë¶€ì‚¬', layout: 'single', count: 10 },
        'gestation4': { title: 'ì„ì‹ ì‚¬ 4ë™', layout: 'single', count: 20 },
        'gestation5': { title: 'ì„ì‹ ì‚¬ 5ë™', layout: 'single', count: 20 }
    };

    function openBuilding(id) {
        const b = buildings[id];
        const grid = document.getElementById('detail-grid');
        document.getElementById('detail-title').innerText = b.title;
        grid.innerHTML = '';
        grid.style.gridTemplateColumns = b.layout === 'lr' ? 'repeat(2, 1fr)' : 'repeat(auto-fill, minmax(70px, 1fr))';

        if (b.layout === 'room') {
            for (let r = 1; r <= b.rooms; r++) {
                const title = document.createElement('div');
                title.className = 'room-title';
                title.innerText = `${r}ë²ˆ ë°©`;
                grid.appendChild(title);
                for (let c = 1; c <= b.perRoom; c++) createCell(grid, `${id}_${r}_${c}`, `${c}ë²ˆ`);
            }
        } else {
            for (let i = 1; i <= b.count; i++) {
                let label = b.layout === 'lr' ? (i%2==1?'ì¢Œ':'ìš°')+Math.ceil(i/2) : i+'ë²ˆ';
                createCell(grid, `${id}_${i}`, label);
            }
        }
        document.getElementById('detail-view').style.display = 'block';
    }

    function createCell(parent, saveKey, label) {
        const val = localStorage.getItem(saveKey) || 0;
        const div = document.createElement('div');
        div.className = 'cell ' + (val == 0 ? '' : (val > 25 ? 'full' : 'active'));
        div.innerHTML = `<span>${label}</span><b>${val}</b>`;
        div.onclick = () => {
            const n = prompt(`${label} ë‘ìˆ˜:`, val);
            if (n !== null) {
                localStorage.setItem(saveKey, n);
                openBuilding(saveKey.split('_')[0]); // ìƒˆë¡œê³ ì¹¨ íš¨ê³¼
            }
        };
        parent.appendChild(div);
    }

    function closeBuilding() { document.getElementById('detail-view').style.display = 'none'; }
</script>
</body>
</html>
